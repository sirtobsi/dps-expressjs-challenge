`Find the task description in the end of the README.md file`

# DPS Backend Coding Challenge (Documentation)

This is my submission to the DPS Backend Coding Challenge. Enjoy and feel free to reach out to me if you have any questions.

## Getting Started

1. Install dependencies using `npm install`
2. Copy the `.env.example` file to `.env` and leave the `DATABASE_URL` as it is
3. Generate the models for the api using `npm run api:gen`
4. Generate the Prisma client (ORM) using `npm run prisma:gen`
5. Run the application using `npm run dev`

The application is now running on `http://localhost:8080`. You can access the API documentation on `http://localhost:8080/api-specs`. If you want to send requests to the backend, use the following token in the `Authorization` header:

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXNzd29yZCI6IlBhc3N3b3JkMTIzIn0.RDGxHLrPkPThUU9QepQqnm-qInz5GyhRC92Z_g1TOYc
```



## Technologies

I added some tools/technologies to the project to make it more robust and maintainable. Here is a list of the technologies used in the project:

- Logging: Winston
- ORM: Prisma
- API Documentation: Swagger (incl. autogenerated API client & models)
- Authentication: JWT
- Validation: zod

## API Documentation

The API documentation is available at `http://localhost:8080/api-specs`. You can also find the API documentation in the `api` folder [(here)](./api/src/api-spec.yaml).

The endpoints expect UUID strings for the `projectId` and `reportId` parameters. Not complying with this will result in a 400 Bad Request response. When creating a project or a report, the `id` field is not required. The `id` field is generated by the database and returned in the response.

#### Default
- *Get Hello World!*
  - `GET /`

#### Projects
- *Get all projects*
  - `GET /projects`
- *Create a project*
  - `POST /projects`
- *Get a project*
  - `GET /projects/{projectId}`
- *Update a project*
  - `PUT /projects/{projectId}`
- *Delete a project*
  - `DELETE /projects/{projectId}`
- *Get all reports of a project*
  - `GET /projects/{projectId}/reports`
- *Create a report for a project*
  - `POST /projects/{projectId}/reports`
- *Get a report of a project*
  - `GET /projects/{projectId}/reports/{reportId}`
- *Update a report of a project*
  - `PUT /projects/{projectId}/reports/{reportId}`
- *Delete a report of a project*
  - `DELETE /projects/{projectId}/reports/{reportId}`

#### Reports
- *Get all reports where the given query word occurs at least 3 times*
  - `GET /reports?query={query}`


## Environment Variables

Please copy the environment variables provided in the `.env.example` file to a new `.env` file. The `DATABASE_URL` variable is already set up for you.

## Database

I decided not to use the initally provided database schema, as it did not enforce any constraints. Instead, I created a new schema using Prisma. The schema can be found in the `prisma` folder [(here)](./prisma/schema.prisma). The database is stored in the `db` folder [(here)](./db/db-tobi.sqlite3).

The schema itself follows the specification from the task description. 

```mermaid
erDiagram
    ProjectDao {
        String id PK
        String name
        String description
    }
    ReportDao {
        String id PK
        String text
        String projectId FK
    }
    ProjectDao ||--o{ ReportDao : "reports"
```

- `PK` indicates a primary key.
- `FK` indicates a foreign key.
- there is a one-to-many relationship between `ProjectDao` and `ReportDao`.




## Project Structure

```plaintext
.
â”œâ”€â”€ README.md                               | this file
â”œâ”€â”€ api                                     | folder containing the API documentation        
â”‚   â”œâ”€â”€ generated
â”‚   â”‚   â”œâ”€â”€ core
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ models                          | generated models
â”‚   â”‚   â””â”€â”€ services
â”‚   â””â”€â”€ src
â”‚       â””â”€â”€ api-spec.yaml                   | API documentation using swagger
â”œâ”€â”€ db                                      | database folder
â”‚   â”œâ”€â”€ db-tobi.sqlite3                     | database file (used in this project)
â”‚   â”œâ”€â”€ db-tobi.sqlite3-journal
â”‚   â””â”€â”€ db.sqlite3
â”œâ”€â”€ images                                  | images used in the README.md
â”‚   â””â”€â”€ database_schema.png
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json                            | npm package file with dependencies & scripts
â”œâ”€â”€ prisma                                  | prisma folder for the ORM
â”‚   â”œâ”€â”€ migrations
â”‚   â”‚   â”œâ”€â”€ 20240714183344_init
â”‚   â”‚   â””â”€â”€ migration_lock.toml
â”‚   â””â”€â”€ schema.prisma                       | prisma schema file
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ controllers                         | controllers for the API
â”‚   â”‚   â”œâ”€â”€ projectController.ts
â”‚   â”‚   â””â”€â”€ reportController.ts
â”‚   â”œâ”€â”€ index.ts                            | main application file
â”‚   â”œâ”€â”€ middleware                          | middleware for the API
â”‚   â”‚   â”œâ”€â”€ auth                            | authentication middleware
â”‚   â”‚   â”œâ”€â”€ errorhandler                    | error handling middleware
â”‚   â”‚   â””â”€â”€ logger                          | logging middleware
â”‚   â”œâ”€â”€ routes                              | routes for the API
â”‚   â”‚   â”œâ”€â”€ projectReportRouter.ts
â”‚   â”‚   â”œâ”€â”€ projectRouter.ts
â”‚   â”‚   â””â”€â”€ reportRouter.ts
â”‚   â””â”€â”€ services                            | services for the API
â”‚       â”œâ”€â”€ converters                      | converters for the API converting between DAOs and DTOs
â”‚       â”œâ”€â”€ db.service.ts                   | NOT USED
â”‚       â”œâ”€â”€ projectService.ts
â”‚       â”œâ”€â”€ reportService.ts
â”‚       â””â”€â”€ validators                      | validators for data received from the API
â””â”€â”€ tsconfig.json
```


## Disclaimer

The structure and the codebase of this project is based on other projects I did in private repositories or university projects. I decided to use an ORM to handle database operations. As software engineers we should not try to reinvent the wheel - instead, we should use off-the-shelf components where possible to guarantee the best quality and maintainability of the codebase while also delivering at a high pace.

For the database, I redefined the schema to enforce FK and unique constraints. This puts some of the responsibility on the database to ensure data integrity - the OS community that implemented the database was probably much more successful in covering all the edge-cases, that I would have forgotten.


# DPS Backend Coding Challenge

## Overview

This repository contains a very basic web application based on Typescript and Express.js. Main application file is `index.ts`. Node and npm are required.

## Environment Setup

Ensure you have Node.js (v14.x or later) and npm (v6.x or later) installed.  
To set up and run the application, execute the following commands:

```
npm install
npm run dev
```

The application will then be accessible at http://localhost:3000.

## Project Context

You will develop a backend system for managing data about a company's projects and their associated reports. Each project may have multiple reports linked to it, though having reports is not mandatory. Start your implementation using the provided SQLite database([db/db.sqlite3](./db/db.sqlite3)).

Refer to the database schema provided for understanding the data structure ðŸ‘‡

![Database schema](images/database_schema.png)

NOTE: You can use ([db.service.ts](./src/services/db.service.ts)) to handle SQL queries to the database.

## Challenge Tasks

-   **Fork this project:** Start by forking this repository
-   **REST API Development:** Design and implement a RESTful API to create, read, update, and delete projects and their reports.
-   **Special API Endpoint:** Create an API endpoint that retrieves all reports where the same word appears at least three times.
-   **Optional:** Secure all API routes with a hardcoded authentication token ("Password123").
-   **Submission:** After completing the challenge, email us the URL of your GitHub repository.
-   **Further information:**
    -   If there is anything unclear regarding requirements, contact us by replying to our email.
    -   Use small commits, we want to see your progress towards the solution.
    -   Code clean and follow the best practices.

\
Happy coding!
